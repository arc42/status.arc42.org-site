import static groovy.io.FileType.*

task specialCollectIncludes (
        description: 'collects all ADR files as inlcude',
        group: 'docToolchain'
) {
    doLast {
        println ("collect ADRs\n")
        def adrFolder = new File (targetDir, "adrs")
        println adrFolder.canonicalPath
        def outFile = new File(targetDir,"adrInclude.adoc")
        println ("write result to "+outFile.canonicalPath)
        outFile.write("//autogenerated through ./dtcw specialCollectIncludes\n\n")
        def includes = []
        adrFolder.traverse(type: FILES) { file ->
            print file.name+"\n"
            includes += "include::adrs/${file.name}[leveloffset=+1]"
        }
        println includes
        outFile.append(includes.sort().join("\n"))
        outFile.append("\n")
    }
}
